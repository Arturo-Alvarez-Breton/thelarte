<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editar Transacción | Thelarte</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .wizard-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        .wizard-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 2rem;
            background: linear-gradient(135deg, #e8f7f2 0%, #f0f8f4 100%);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .wizard-step {
            flex: 1;
            text-align: center;
            padding: 1rem;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
            color: #7b5222;
            position: relative;
        }
        .wizard-step:not(:last-child)::after {
            content: '';
            position: absolute;
            right: -25px;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 2px;
            background: #dee2e6;
            z-index: 1;
        }
        .wizard-step.active {
            background: #59391B;
            color: white;
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(89, 57, 27, 0.3);
            z-index: 2;
        }
        .wizard-step.completed {
            background: #28a745;
            color: white;
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }
        .wizard-step.completed::after {
            background: #28a745;
        }
        .step-content {
            display: none;
            background: white;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid #e9ecef;
        }
        .step-content.active {
            display: block;
        }
        .counterpart-card {
            border: 2px solid #dee2e6;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }
        .counterpart-card:hover {
            border-color: #59391B;
            background: #f8f9fa;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .counterpart-card.selected {
            border-color: #59391B;
            background: #f0f8f4;
            box-shadow: 0 4px 16px rgba(89, 57, 27, 0.2);
        }
        .product-item {
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            background: #f8f9fa;
        }
        .transaction-summary {
            background: linear-gradient(135deg, #f0f8f4 0%, #e8f7f2 100%);
            border-radius: 12px;
            padding: 2rem;
            border: 2px solid #e8f7f2;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .currency-amount {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #59391B;
        }
        .transaction-type-badge {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .tipo-venta {
            background: linear-gradient(135deg, #7b5222, #59391B);
            color: white;
        }
        .tipo-compra {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }
        .tipo-devolucion {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
        }
        
        /* Toggle switch styling */
        .dot {
            transition: transform 0.3s ease-in-out;
        }
        .translate-x-4 {
            transform: translateX(1rem);
        }
        
        /* Out of stock styling */
        .counterpart-card.opacity-70 {
            cursor: not-allowed;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
<!-- Header Thelarte -->
<header class="flex flex-col items-center mt-6 mb-4">
  <div class="flex items-end">
    <h1 class="font-serif text-2xl md:text-4xl font-bold bg-[#59391B] text-white tracking-wider mr-2 px-3 md:px-4 py-2 rounded">Thel</h1>
    <h1 class="font-bold text-3xl md:text-5xl italic text-[#7b5222] font-cursive" style="font-family: cursive;">Arte</h1>
  </div>
  <div class="font-serif text-gray-500 tracking-widest text-sm md:text-base font-medium mt-2">GALERÍA Y DECORACIÓN</div>
</header>

<main class="flex-1 px-4 md:px-8 lg:px-12 xl:px-16 w-full max-w-6xl mx-auto">
  <div class="wizard-container">
    <div class="p-6 md:p-8">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6 gap-4">
        <div>
          <h2 class="text-2xl md:text-3xl font-bold font-serif text-[#59391B] mb-2">Editar Transacción</h2>
          <span id="tipoTransaccionBadge" class="transaction-type-badge"></span>
        </div>
        <button type="button" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition text-sm md:text-base" onclick="window.location.href='index.html'">
          <i class="fas fa-arrow-left mr-2"></i>Volver
        </button>
      </div>

      <div class="wizard-steps">
        <div class="wizard-step active" data-step="1">
          <i class="fas fa-info-circle mb-2 text-xl"></i>
          <div class="font-semibold text-sm">Información</div>
        </div>
        <div class="wizard-step" data-step="2">
          <i class="fas fa-user-tie mb-2 text-xl"></i>
          <div class="font-semibold text-sm" id="contraparteStepLabel">Contraparte</div>
        </div>
        <div class="wizard-step" data-step="3">
          <i class="fas fa-boxes mb-2 text-xl"></i>
          <div class="font-semibold text-sm">Productos</div>
        </div>
        <div class="wizard-step" data-step="4">
          <i class="fas fa-check-circle mb-2 text-xl"></i>
          <div class="font-semibold text-sm">Confirmar</div>
        </div>
      </div>

      <form id="transaccionForm">
        <!-- Paso 1: Información General -->
        <div class="step-content active" id="step1">
          <h3 class="text-xl font-bold text-[#59391B] mb-6">Información de la Transacción</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium text-[#59391B] mb-2">Tipo de Transacción</label>
              <input type="text" id="tipoDisplay" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg bg-gray-100 text-gray-700 font-medium" readonly>
              <input type="hidden" id="tipo">
            </div>
            <div>
              <label for="fecha" class="block text-sm font-medium text-[#59391B] mb-2">Fecha y Hora</label>
              <input type="datetime-local" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-[#59391B] focus:ring-2 focus:ring-[#59391B] focus:ring-opacity-20 transition-colors" id="fecha" required>
            </div>
            <div>
              <label for="numeroFactura" class="block text-sm font-medium text-[#59391B] mb-2">Número de Factura</label>
              <input type="text" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-[#59391B] focus:ring-2 focus:ring-[#59391B] focus:ring-opacity-20 transition-colors" id="numeroFactura" placeholder="Opcional">
            </div>
            <div>
              <label for="observaciones" class="block text-sm font-medium text-[#59391B] mb-2">Observaciones</label>
              <textarea class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-[#59391B] focus:ring-2 focus:ring-[#59391B] focus:ring-opacity-20 transition-colors" id="observaciones" rows="3" placeholder="Notas adicionales..."></textarea>
            </div>
          </div>
        </div>

        <!-- Paso 2: Contraparte -->
        <div class="step-content" id="step2">
          <h3 class="text-xl font-bold text-[#59391B] mb-6" id="contraparteTitle">Seleccionar Contraparte</h3>
          <div id="contraparteContainer">
            <div class="text-center py-12">
              <div class="animate-spin inline-block w-8 h-8 border-4 border-current border-t-transparent text-[#7b5222] rounded-full">
                <span class="sr-only">Cargando...</span>
              </div>
              <p class="text-gray-600 mt-4">Cargando lista de contrapartes...</p>
            </div>
          </div>
        </div>

        <!-- Paso 3: Productos -->
        <div class="step-content" id="step3">
          <h3 class="text-xl font-bold text-[#59391B] mb-6">Seleccionar Productos</h3>
          <div id="productosContainer">
            <div class="text-center py-12">
              <div class="animate-spin inline-block w-8 h-8 border-4 border-current border-t-transparent text-[#7b5222] rounded-full">
                <span class="sr-only">Cargando...</span>
              </div>
              <p class="text-gray-600 mt-4">Cargando productos...</p>
            </div>
          </div>
          <div id="productosSeleccionados" class="mt-6" style="display: none;">
            <h4 class="text-lg font-semibold text-[#59391B] mb-4">Productos Seleccionados</h4>
            <div id="listaProductosSeleccionados"></div>
          </div>
          <div class="transaction-summary mt-6" id="resumenProductos" style="display: none;">
            <h4 class="text-lg font-bold text-[#59391B] mb-4">Resumen</h4>
            <div class="space-y-2">
              <div class="flex justify-between">
                <span>Subtotal:</span>
                <span class="currency-amount" id="subtotalDisplay">RD$ 0,00</span>
              </div>
              <div class="flex justify-between">
                <span>ITBIS (18%):</span>
                <span class="currency-amount" id="itbisDisplay">RD$ 0,00</span>
              </div>
              <div class="flex justify-between text-lg font-bold border-t-2 border-[#59391B] pt-2">
                <span>Total:</span>
                <span class="currency-amount text-xl" id="totalDisplay">RD$ 0,00</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Paso 4: Confirmación -->
        <div class="step-content" id="step4">
          <h3 class="text-xl font-bold text-[#59391B] mb-6">Confirmar Cambios</h3>
          <div class="transaction-summary">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
              <div>
                <h4 class="font-semibold text-[#59391B] mb-3">Información General</h4>
                <div class="space-y-2 text-sm">
                  <div class="flex justify-between">
                    <span class="text-gray-600">Tipo:</span>
                    <span id="confirmTipo" class="font-medium"></span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-600">Fecha:</span>
                    <span id="confirmFecha" class="font-medium"></span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-600" id="confirmContraparteLabel">Contraparte:</span>
                    <span id="confirmContraparte" class="font-medium"></span>
                  </div>
                </div>
              </div>
              <div>
                <h4 class="font-semibold text-[#59391B] mb-3">Totales</h4>
                <div class="space-y-2">
                  <div class="flex justify-between">
                    <span class="text-gray-600">Subtotal:</span>
                    <span class="currency-amount" id="confirmSubtotal">RD$ 0,00</span>
                  </div>
                  <div class="flex justify-between">
                    <span class="text-gray-600">ITBIS:</span>
                    <span class="currency-amount" id="confirmItbis">RD$ 0,00</span>
                  </div>
                  <div class="flex justify-between text-lg font-bold border-t-2 border-[#59391B] pt-2">
                    <span>Total:</span>
                    <span class="currency-amount text-xl" id="confirmTotal">RD$ 0,00</span>
                  </div>
                </div>
              </div>
            </div>
            <div>
              <h4 class="font-semibold text-[#59391B] mb-3">Productos</h4>
              <div id="confirmProductos" class="space-y-2 max-h-40 overflow-y-auto"></div>
            </div>
          </div>
        </div>
      </form>

      <div class="flex justify-between items-center mt-8 pt-6 border-t border-gray-200">
        <button type="button" class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded-lg transition shadow-md text-sm md:text-base font-medium" id="btnAnterior" onclick="anteriorPaso()" style="display: none;">
          <i class="fas fa-arrow-left mr-2"></i>Anterior
        </button>
        <div class="flex gap-3">
          <button type="button" class="bg-[#59391B] hover:bg-[#7b5222] text-white px-6 py-3 rounded-lg transition shadow-md text-sm md:text-base font-medium" id="btnSiguiente" onclick="siguientePaso()">
            Siguiente<i class="fas fa-arrow-right ml-2"></i>
          </button>
          <button type="button" class="bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-lg transition shadow-md text-sm md:text-base font-medium" id="btnConfirmar" onclick="confirmarTransaccion()" style="display: none;">
            <i class="fas fa-save mr-2"></i>Guardar Cambios
          </button>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- Loading Overlay -->
<div id="loadingOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg p-6 flex items-center">
    <div class="animate-spin h-6 w-6 border-4 border-[#7b5222] border-t-transparent rounded-full mr-3"></div>
    <span class="text-[#59391B] font-medium">Procesando transacción...</span>
  </div>
</div>

<footer class="w-full text-center py-4 text-gray-400 text-sm mt-8">
  &copy; 2025 Thelarte.
</footer>

<script src="../../js/services/transaccionService.js"></script>
<script src="../../js/transaccion/edit.js"></script>
</body>
</html>
            <div>
              <h4 class="font-semibold text-[#59391B] mb-3">Productos</h4>
              <div id="confirmProductos" class="space-y-2 max-h-40 overflow-y-auto"></div>
            </div>
          </div>
          
          <div class="mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
            <p class="text-yellow-800">
              <i class="fas fa-exclamation-triangle mr-2"></i>
              <strong>Importante:</strong> Al guardar los cambios, se actualizará la información de la transacción. Verifique que todos los datos sean correctos.
            </p>
          </div>
        </div>
      </form>

      <div class="flex justify-between items-center mt-8 pt-6 border-t border-gray-200">
        <button type="button" class="bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded-lg transition shadow-md text-sm md:text-base font-medium" id="btnAnterior" onclick="anteriorPaso()" style="display: none;">
          <i class="fas fa-arrow-left mr-2"></i>Anterior
        </button>
        <div class="flex gap-3">
          <button type="button" class="bg-[#59391B] hover:bg-[#7b5222] text-white px-6 py-3 rounded-lg transition shadow-md text-sm md:text-base font-medium" id="btnSiguiente" onclick="siguientePaso()">
            Siguiente<i class="fas fa-arrow-right ml-2"></i>
          </button>
          <button type="button" class="bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-lg transition shadow-md text-sm md:text-base font-medium" id="btnConfirmar" onclick="guardarCambiosTransaccion()" style="display: none;">
            <i class="fas fa-save mr-2"></i>Guardar Cambios
          </button>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- Loading Overlay -->
<div id="loadingOverlay" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <div class="bg-white rounded-lg p-6 flex items-center">
    <div class="animate-spin h-6 w-6 border-4 border-[#7b5222] border-t-transparent rounded-full mr-3"></div>
    <span class="text-[#59391B] font-medium">Procesando...</span>
  </div>
</div>

<footer class="w-full text-center py-4 text-gray-400 text-sm mt-8">
  &copy; 2025 Thelarte.
</footer>

<script src="../../js/services/transaccionService.js"></script>
<script src="../../js/transaccion/edit.js"></script>
</body>
</html>
